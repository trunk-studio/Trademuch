// import should from 'should'
import supertest from 'supertest'
import sinon from 'sinon'
var request = supertest('http://localhost:1338');

describe('upload', function() {
  before(async (done) => {
    try {
      let user = await User.create({
        "username": "testPost",
  			"email": "testPost1@gmail.com",
  			"age": 18
      });

      sinon.stub(UserService, 'getLoginState', (req) => {
        return true;
      });

      sinon.stub(UserService, 'getLoginUser', (req) => {
        return user;
      });


      done();
    } catch (e) {
      sails.log.error(e);
      done(e);
    }
  });

  after(async (done) => {
    UserService.getLoginState.restore();
    UserService.getLoginUser.restore();
    done();
  });
  it('a file', function (done)  {
    try {
      request.post('/rest/image/upload')
       .send({
         picBase64: 'data:image/jpeg;base64,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'
       })
       .end(function(err, res) {
          //  console.log(res.body[0]);
           res.status.should.be.equal(200) // 'success' status
           done()
       });
    } catch (e) {
      sails.log.error(e);
      done(e);
    }

  });
});
